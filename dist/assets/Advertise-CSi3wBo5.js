import{c as F,r as b,u as T,w as P,V as h,j as e,x as U,F as I,y as D,m as O,n as q,T as B,q as G,E as V,z,M as H,D as J,a as Y,X as L,L as W,G as X}from"./index-DwL5i53P.js";import{U as K,S as Q}from"./upload-CyEpXp6C.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],_=F("pen-line",Z);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],S=F("plus",ee);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],$=F("trash-2",te),se=["Electronics","Fashion","Home & Garden","Sports","Books","Automotive","Health & Beauty","Food & Beverages","Education","Services","Others"],re=({status:r})=>{const g={approved:{bg:"bg-green-100",text:"text-green-800",border:"border-green-200"},pending:{bg:"bg-yellow-100",text:"text-yellow-800",border:"border-yellow-200"},rejected:{bg:"bg-red-100",text:"text-red-800",border:"border-red-200"}},i=g[r]||g.pending;return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${i.bg} ${i.text} ${i.border}`,children:r.charAt(0).toUpperCase()+r.slice(1)})},oe=()=>{const[r,g]=b.useState([]),[i,w]=b.useState(!0),{user:d,profile:A,hasActiveSubscription:o,isSubscriptionExpired:C,getSubscriptionStatus:f}=T(),[x,v]=b.useState({isOpen:!1,advertisement:null});b.useEffect(()=>{j()},[]);const j=async()=>{w(!0);try{const a=await P();if(a.success){const N=a.data.map(m=>({id:m.id,serialNumber:m.serial_number||m.id?.toString()||"N/A",category:m.category||"Uncategorized",title:m.title||"No Title",description:m.description||"No Description",status:m.status||"pending",views:m.views||0,createdAt:m.created_at,images:m.images||[],url:m.url||null}));g(N)}else h.error(a.error||"Failed to fetch advertisements"),g([])}catch(a){console.error("Error fetching advertisements:",a),h.error("An unexpected error occurred"),g([])}finally{w(!1)}},l=a=>{v({isOpen:!0,advertisement:a})},c=async(a,N)=>{if(window.confirm(`Are you sure you want to delete "${N}"? This action cannot be undone.`))try{const k=await z(a);k.success?(h.success("Advertisement deleted successfully"),j()):h.error(k.error||"Failed to delete advertisement")}catch(k){console.error("Error deleting advertisement:",k),h.error("An unexpected error occurred while deleting")}},y=()=>{v({isOpen:!1,advertisement:null})},E=()=>{j()};return i?e.jsxs("div",{className:"flex-1 p-4 w-full bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-5 bg-white p-6 rounded-xl shadow-sm",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-2",children:"My Advertisements"}),e.jsx("p",{className:"text-gray-600",children:r.length>0?`${r.length} advertisement${r.length!==1?"s":""} found`:"Manage and track your advertisement campaigns"})]}),e.jsx("div",{className:"mt-4 md:mt-0 flex flex-col items-end gap-2",children:o()?e.jsxs(U,{to:"/dashboard/newadvertise",className:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200 shadow-sm",children:[e.jsx(S,{className:"h-5 w-5"}),"Create New Ad"]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{disabled:!0,className:"inline-flex items-center gap-2 bg-gray-400 cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium opacity-60",children:[e.jsx(S,{className:"h-5 w-5"}),"Create New Ad"]}),e.jsxs("p",{className:"text-sm text-red-600 text-right",children:["Premium subscription required to create ads."," ",e.jsx(U,{to:"/pricing",className:"text-blue-600 hover:underline font-medium",children:"Upgrade Plan"})]})]})})]}),e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600"}),e.jsx("div",{className:"text-lg text-gray-600",children:"Loading advertisements..."})]})})]}):e.jsxs("div",{className:"flex-1 p-4 w-full bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-5 bg-white p-6 rounded-xl shadow-sm",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-2",children:"My Advertisements"}),e.jsx("p",{className:"text-gray-600",children:r.length>0?`${r.length} advertisement${r.length!==1?"s":""} found`:"Manage and track your advertisement campaigns"})]}),e.jsxs(U,{to:"/dashboard/newadvertise",className:"mt-4 md:mt-0 inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200 shadow-sm",children:[e.jsx(S,{className:"h-5 w-5"}),"Create New Ad"]})]}),r.length===0?e.jsx("div",{className:"flex flex-col justify-center items-center p-3 h-auto bg-white rounded-xl shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(I,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No advertisements yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Get started by creating your first advertisement"}),o()?e.jsxs(U,{to:"/dashboard/newadvertise",className:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200",children:[e.jsx(S,{className:"h-5 w-5"}),"Create Your First Ad"]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{disabled:!0,className:"inline-flex items-center gap-2 bg-gray-400 cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium opacity-60",children:[e.jsx(S,{className:"h-5 w-5"}),"Create Your First Ad"]}),e.jsxs("p",{className:"text-sm text-red-600",children:["Premium subscription required to create ads."," ",e.jsx(U,{to:"/pricing",className:"text-blue-600 hover:underline font-medium",children:"Upgrade your plan"})]})]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((a,N)=>e.jsx(ae,{...a,advertisementData:a,onEdit:l,onDelete:c},`${a.serialNumber}-${N}`))}),e.jsx(le,{isOpen:x.isOpen,onClose:y,advertisement:x.advertisement,onUpdate:E})]})},ae=({category:r,title:g,description:i,status:w,onDelete:d,createdAt:A,images:o,url:C,onEdit:f,advertisementData:x})=>{const v=c=>new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),j=(c,y=80)=>c?c.length>y?c.substring(0,y)+"...":c:"No description available",l=o&&o.length>0?D(o[0].image):null;return e.jsx(O,{className:"group p-0 hover:shadow-lg transition-all duration-300 border-0 shadow-sm bg-white rounded-xl overflow-hidden",children:e.jsxs(q,{className:"p-0",children:[l&&e.jsxs("div",{className:"relative h-36 bg-gray-100 overflow-hidden",children:[e.jsx("img",{src:l,alt:g,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:c=>{c.target.style.display="none",c.target.parentElement.style.display="none"}}),o.length>1&&e.jsxs("div",{className:"absolute top-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded-full",children:["+",o.length-1," more"]}),e.jsxs("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1",children:[e.jsx("button",{onClick:()=>f(x),className:"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-full shadow-lg transition-colors",title:"Edit Advertisement",children:e.jsx(_,{className:"h-3 w-3"})}),e.jsx("button",{onClick:()=>d(x.id,x.title),className:"bg-red-600 hover:bg-red-700 text-white p-2 rounded-full shadow-lg transition-colors",title:"Delete Advertisement",children:e.jsx($,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"p-2 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm leading-tight line-clamp-2 mb-1",children:g||"Untitled Advertisement"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(B,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium text-blue-600",children:r})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{status:w}),!l&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>f(x),className:"p-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-full transition-colors",title:"Edit Advertisement",children:e.jsx(_,{className:"h-3 w-3"})}),e.jsx("button",{onClick:()=>d(x.id,x.title),className:"p-1.5 bg-red-600 hover:bg-red-700 text-white rounded-full transition-colors",title:"Delete Advertisement",children:e.jsx($,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(I,{className:"h-3 w-3 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:j(i)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(G,{className:"h-3 w-3 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-900",children:v(A)}),e.jsx("div",{className:"text-xs text-gray-500",children:"Created"})]})]}),C&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(V,{className:"h-3 w-3 text-gray-400"}),e.jsxs("div",{children:[e.jsx("a",{href:C,target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium text-blue-600 hover:text-blue-800 truncate block",children:"Visit Link"}),e.jsx("div",{className:"text-xs text-gray-500",children:"URL"})]})]})]})]})]})})},le=({isOpen:r,onClose:g,advertisement:i,onUpdate:w})=>{const[d,A]=b.useState({title:"",description:"",category:"",url:""}),[o,C]=b.useState([]),[f,x]=b.useState([]),[v,j]=b.useState([]),[l,c]=b.useState(!1),[y,E]=b.useState([]);b.useEffect(()=>{i&&r&&(A({title:i.title||"",description:i.description||"",category:i.category||"",url:i.url||""}),C(i.images||[]),x([]),j([]),E([]))},[i,r]);const a=s=>{const{name:t,value:u}=s.target;A(n=>({...n,[t]:u}))},N=s=>{const t=Array.from(s.target.files);if(t.length+o.length+f.length>10){h.error("Maximum 10 images allowed");return}const u=t.filter(n=>{const p=n.type.startsWith("image/")&&n.size<=5242880;return p||h.error(`${n.name} is not a valid image or exceeds 5MB`),p});if(u.length>0){x(p=>[...p,...u]);const n=u.map(p=>URL.createObjectURL(p));E(p=>[...p,...n])}},m=s=>{const t=o[s];j(u=>[...u,t.id||s]),C(u=>u.filter((n,p)=>p!==s))},k=s=>{y[s]&&URL.revokeObjectURL(y[s]),x(t=>t.filter((u,n)=>n!==s)),E(t=>t.filter((u,n)=>n!==s))},R=async s=>{if(s.preventDefault(),!d.title.trim()){h.error("Title is required");return}if(!d.category){h.error("Category is required");return}c(!0);try{const t=new FormData;t.append("title",d.title.trim()),t.append("description",d.description.trim()),t.append("category",d.category),t.append("url",d.url.trim()),f.forEach((n,p)=>{t.append("uploaded_images",n)}),v.length>0&&t.append("images_to_delete",JSON.stringify(v));const u=await X(i.id,t);u.success?(h.success("Advertisement updated successfully"),w(),g(),y.forEach(n=>URL.revokeObjectURL(n))):h.error(u.error||"Failed to update advertisement")}catch(t){console.error("Error updating advertisement:",t),h.error("An unexpected error occurred")}finally{c(!1)}},M=()=>{y.forEach(s=>URL.revokeObjectURL(s)),g()};return r?e.jsx(H,{isOpen:r,onClose:M,children:e.jsxs(J,{onClose:M,className:Y("max-w-xl bg-white rounded-xl shadow-2xl  w-full max-h-[90vh] overflow-y-auto"),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Advertisement"}),e.jsx("button",{onClick:M,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",disabled:l,children:e.jsx(L,{className:"h-5 w-5 text-gray-500"})})]}),e.jsxs("form",{onSubmit:R,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx("input",{type:"text",name:"title",value:d.title,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-colors",placeholder:"Enter advertisement title",required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{name:"description",value:d.description,onChange:a,rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-colors",placeholder:"Enter advertisement description",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),e.jsxs("select",{name:"category",value:d.category,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-colors",required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select a category"}),se.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL"}),e.jsx("input",{type:"url",name:"url",value:d.url,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-colors",placeholder:"https://example.com",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Images (Max 10)"}),o.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Current Images"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:o.map((s,t)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:D(s.image),alt:`Existing ${t+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),e.jsx("button",{type:"button",onClick:()=>m(t),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",disabled:l,children:e.jsx(L,{className:"h-3 w-3"})})]},t))})]}),f.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"New Images"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:f.map((s,t)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:y[t],alt:`New ${t+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),e.jsx("button",{type:"button",onClick:()=>k(t),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",disabled:l,children:e.jsx(L,{className:"h-3 w-3"})})]},t))})]}),o.length+f.length<10&&e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:N,className:"hidden",id:"image-upload",disabled:l}),e.jsxs("label",{htmlFor:"image-upload",className:"cursor-pointer flex flex-col items-center space-y-2",children:[e.jsx(K,{className:"h-8 w-8 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Click to upload images"}),e.jsx("span",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 5MB each"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Current: ",o.length+f.length,"/10 images"]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",disabled:l,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-4 w-4 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"h-4 w-4"}),"Update Advertisement"]})})]})]})]})}):null};export{se as categories,oe as default};
